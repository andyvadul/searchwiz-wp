(()=>{"use strict";const e=window.React,t=window.wp.element,n=window.wp.i18n,o=({result:t})=>{if(!t)return null;const{id:n,title:o,excerpt:r,url:a,thumbnail:i,type:s,date:l}=t,c=e=>({__html:e||""});return(0,e.createElement)("div",{"data-id":n,className:`is-ajax-search-post is-ajax-search-post-${n}`,style:{display:"block",padding:"10px",borderBottom:"1px solid #ccc",height:"auto",overflow:"visible"}},(0,e.createElement)("div",{className:"is-search-sections",style:{display:"block",height:"auto"}},i&&(0,e.createElement)("div",{className:"left-section",style:{float:"left",marginRight:"15px"}},(0,e.createElement)("div",{className:"thumbnail"},(0,e.createElement)("a",{href:a},(0,e.createElement)("img",{src:i,alt:o,style:{maxWidth:"100px"}})))),(0,e.createElement)("div",{className:"right-section",style:{display:"block",overflow:"hidden"}},(0,e.createElement)("div",{className:"is-title",style:{marginBottom:"8px"}},(0,e.createElement)("a",{href:a,style:{color:"#0073aa",fontSize:"16px",fontWeight:"bold",textDecoration:"none"},dangerouslySetInnerHTML:c(o)})),(0,e.createElement)("div",{className:"meta",style:{marginBottom:"8px",fontSize:"13px",color:"#666"}},(0,e.createElement)("div",null,l&&(0,e.createElement)("span",{className:"is-date",style:{marginRight:"10px"}},l),s&&(0,e.createElement)("span",{className:"is-type"},s))),r&&(0,e.createElement)("div",{className:"is-search-content",style:{fontSize:"14px",lineHeight:"1.5"}},(0,e.createElement)("div",{className:"is-description",style:{color:"#313131"},dangerouslySetInnerHTML:c(r)})))))},r=({result:t})=>{if(!t||!t.product)return null;const{id:o,title:r,excerpt:a,url:i,thumbnail:s,product:l}=t,c=e=>({__html:e||""});return(0,e.createElement)("div",{"data-id":o,className:"searchwiz-product-card",style:{display:"block",padding:"15px",border:"1px solid #ddd",borderRadius:"4px",marginBottom:"10px",background:"white",height:"auto",overflow:"visible"}},(0,e.createElement)("div",{style:{display:"flex",gap:"15px"}},s&&(0,e.createElement)("div",{style:{flexShrink:0}},(0,e.createElement)("a",{href:i},(0,e.createElement)("img",{src:s,alt:r,style:{width:"100px",height:"100px",objectFit:"cover",borderRadius:"4px"}}))),(0,e.createElement)("div",{style:{flex:1,minWidth:0}},(0,e.createElement)("div",{style:{marginBottom:"8px"}},(0,e.createElement)("a",{href:i,style:{color:"#0073aa",fontSize:"16px",fontWeight:"bold",textDecoration:"none",display:"block"},dangerouslySetInnerHTML:c(r)})),(0,e.createElement)("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginBottom:"8px"}},l.price_html&&(0,e.createElement)("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},dangerouslySetInnerHTML:{__html:l.price_html}}),void 0!==l.in_stock&&(0,e.createElement)("div",{style:{padding:"3px 8px",borderRadius:"3px",fontSize:"12px",fontWeight:"600",background:l.in_stock?"#d4edda":"#f8d7da",color:l.in_stock?"#155724":"#721c24"}},l.in_stock?(0,n.__)("In Stock","searchwiz"):(0,n.__)("Out of Stock","searchwiz")),l.on_sale&&(0,e.createElement)("div",{style:{padding:"3px 8px",borderRadius:"3px",fontSize:"12px",fontWeight:"600",background:"#ff6b6b",color:"white"}},(0,n.__)("SALE!","searchwiz"))),l.rating>0&&(0,e.createElement)("div",{style:{marginBottom:"8px",fontSize:"13px",color:"#666"}},"â˜… ",l.rating," (",l.review_count," ",(0,n.__)("reviews","searchwiz"),")"),a&&(0,e.createElement)("div",{style:{fontSize:"14px",lineHeight:"1.5",color:"#555"},dangerouslySetInnerHTML:c(a)}),l.sku&&(0,e.createElement)("div",{style:{fontSize:"12px",color:"#999",marginTop:"5px"}},(0,n.__)("SKU:","searchwiz")," ",l.sku))))},a=()=>{const[a,i]=(0,t.useState)([]),[s,l]=(0,t.useState)([]),[c,d]=(0,t.useState)(!1),[u,p]=(0,t.useState)(!1),[g,h]=(0,t.useState)(null),[m,f]=(0,t.useState)(""),[w,y]=(0,t.useState)(null),[x,b]=(0,t.useState)(!1),[v,E]=(0,t.useState)(1),[S,z]=(0,t.useState)(!1),[_,k]=(0,t.useState)(null),[L,I]=(0,t.useState)(!1),[M,R]=(0,t.useState)(65),[T,D]=(0,t.useState)(!1),W=window.searchwizDebug?.enabled||!1,[B]=(0,t.useState)(()=>{const e=new URLSearchParams(window.location.search);return"true"===e.get("isSearchpage")||e.has("s")}),N=window.searchwiz||{ajax_url:"",nonce:"",query:""};(0,t.useEffect)(()=>{const e=document.getElementById("searchwiz-react-results");if(e)if(c||a.length>0||g){if(e.style.display="block",B)return void window.searchwizDebug?.log("ðŸ“„ Search results page - using PHP positioning");if(w){const t=w.closest("form")||w.parentElement;if(t){e.parentElement!==t.parentElement&&t.parentElement.insertBefore(e,t.nextSibling);const n=t.getBoundingClientRect();if(e.style.overflowY="visible",e.style.transition="width 0.3s ease-in-out, left 0.3s ease-in-out, min-width 0.3s ease-in-out, max-width 0.3s ease-in-out",L){const t=window.innerWidth,o=.8*t;window.searchwizDebug?.log("ðŸ”¼ MAXIMIZING",{viewportWidth:t,maxWidth:o,formRect:n}),e.style.position="fixed",e.style.width=`${o}px`,e.style.minWidth=`${o}px`,e.style.maxWidth=`${o}px`,e.style.left=(t-o)/2+"px",e.style.top=`${n.bottom+10}px`,e.style.zIndex="1000000"}else{const t=Math.max(n.width,600),o=t>n.width?-(t-n.width)/2:0;window.searchwizDebug?.log("ðŸ”½ MINIMIZING",{normalWidth:t,formRect:n,leftOffset:o}),e.style.position="absolute",e.style.top=`${n.height}px`,e.style.left=`${o}px`,e.style.width=`${t}px`,e.style.minWidth=`${t}px`,e.style.maxWidth=`${t}px`,e.style.zIndex="999999"}}}}else 0===m.length&&(e.style.display="none")},[a,c,g,m,w,L]),(0,t.useEffect)(()=>{const e=document.querySelectorAll(".searchwiz-search-input");let t="",n=null;const o=(e,t)=>{if(f(e),y(t),n&&(clearTimeout(n),n=null),e.length<3)return i([]),l([]),h(null),void E(1);n=setTimeout(()=>{E(1),i([]),l([]),C(e,1)},250)},r=new URLSearchParams(window.location.search).get("s");if(r&&r.trim().length>=3&&(m!==r.trim()?o(r.trim(),null):y(null)),0===e.length&&!r)return void window.searchwizDebug?.log("âš ï¸ Search input (.searchwiz-search-input) not found and not on search results page");const a=setInterval(()=>{let n=!1;for(let r of e){const e=r.value.trim();if(e){n=!0,e!==t&&(t=e,o(e,r));break}}!n&&t&&(t="",o("",null))},300),s=e=>{const n=e.target.value.trim();n!==t&&(t=n,o(n,e.target))};return e.forEach(e=>{e.addEventListener("input",s,!0),e.addEventListener("keyup",s,!0)}),()=>{clearInterval(a),n&&clearTimeout(n),e.forEach(e=>{e.removeEventListener("input",s,!0),e.removeEventListener("keyup",s,!0)})}},[]);const C=async(e,t=1,o=!1)=>{o?p(!0):d(!0),h(null);try{window.searchwizDebug?.log(`ðŸ“„ Fetching page ${t} for "${e}"`,{append:o});const n=new FormData;n.append("action","searchwiz_search_json"),n.append("s",e),n.append("id",N.form_id||8),n.append("page",t),n.append("security",N.nonce);const r=await fetch(N.ajax_url,{method:"POST",credentials:"same-origin",body:n}),a=await r.json();a.success?(window.searchwizDebug?.log(`âœ… Page ${t} loaded:`,{products:a.data.products?.length||0,posts:a.data.results?.length||0,hasMore:a.data.has_more}),z(a.data.has_more||!1),b(a.data.woocommerce_active||!1),o?(i(e=>[...e,...a.data.results||[]]),l(e=>[...e,...a.data.products||[]])):(i(a.data.results||[]),l(a.data.products||[]))):o||(i([]),l([]))}catch(e){h((0,n.__)("Failed to fetch results","searchwiz"))}finally{d(!1),p(!1)}};(0,t.useEffect)(()=>{if(!S||u)return;const e=document.getElementById("searchwiz-scroll-sentinel");if(!e)return void window.searchwizDebug?.log("âš ï¸ Sentinel not found, waiting for next render");const t=new IntersectionObserver(e=>{e[0].isIntersecting&&(window.searchwizDebug?.log(`ðŸ”½ Sentinel visible - loading page ${v+1}`),(()=>{if(!u&&S&&m){p(!0);const e=v+1;E(e),C(m,e,!0)}})())},{root:null,threshold:.1,rootMargin:"100px"});return window.searchwizDebug?.log("ðŸ‘ï¸ Observing sentinel",{hasMore:S,currentPage:v}),t.observe(e),()=>t.disconnect()},[S,u,v,a,s]);const $=s.length+a.length,P=s.length>0,H=a.length>0,A=()=>{try{window.searchwizDebug?.log("âŒ closeResults called",{resultsCount:a.length,currentQuery:m,stackTrace:(new Error).stack}),i([]),l([]),f(""),h(null),E(1),w&&(w.value="")}catch(e){window.searchwizDebug?.log("âŒ Error in closeResults:",e),console.error("Error closing results:",e)}};(0,t.useEffect)(()=>{const e=e=>{"Escape"===e.key&&(a.length>0||s.length>0||g)&&(e.preventDefault(),e.stopPropagation(),A())};return document.addEventListener("keydown",e,!0),()=>{document.removeEventListener("keydown",e,!0)}},[a,s,g,w]);const F=()=>{D(!1)};return(0,e.createElement)("div",{style:{background:B?"transparent":"#f0f0f0",border:B?"none":"2px solid #0073aa",padding:"20px",zIndex:999999,boxShadow:B?"none":"0 2px 10px rgba(0,0,0,0.1)",display:"block",minHeight:"50px",maxHeight:B?"none":"80vh",overflowY:B?"visible":"auto"}},!B&&(0,e.createElement)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation();const t=!L;window.searchwizDebug?.log(`ðŸ”² Maximize button clicked: ${L?"MINIMIZING":"MAXIMIZING"} -> ${t}`,{currentState:L,newState:t,currentQuery:m,resultsCount:a.length}),I(t)},style:{position:"absolute",top:"10px",right:"55px",background:W?"#f0f0f0":"transparent",color:"#0073aa",border:"none",outline:"none",borderRadius:W?"3px":"0",width:"32px",height:"32px",cursor:"pointer",fontSize:"18px",fontWeight:"bold",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e6,transition:"transform 0.2s"},onMouseOver:e=>{e.target.style.transform="scale(1.1)",W&&(e.target.style.background="#e8e8e8")},onMouseOut:e=>{e.target.style.transform="scale(1)",W&&(e.target.style.background="#f0f0f0")},title:L?(0,n.__)("Minimize","searchwiz"):(0,n.__)("Maximize","searchwiz")},L?"â–¼":"â–²"),!B&&(0,e.createElement)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),window.searchwizDebug?.log("âŒ Close button (Ã—) clicked"),A()},style:{position:"absolute",top:"10px",right:"10px",background:W?"#ffebee":"transparent",color:"#d32f2f",border:"none",outline:"none",borderRadius:W?"3px":"0",width:"32px",height:"32px",cursor:"pointer",fontSize:"20px",fontWeight:"bold",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e6,transition:"transform 0.2s"},onMouseOver:e=>{e.target.style.transform="scale(1.1)",W&&(e.target.style.background="#ffcdd2")},onMouseOut:e=>{e.target.style.transform="scale(1)",W&&(e.target.style.background="#ffebee")},title:(0,n.__)("Close search results","searchwiz")},"Ã—"),(0,e.createElement)("h3",{style:{margin:"0 0 15px 0",color:"#333",fontSize:"18px",borderBottom:"2px solid #0073aa",paddingBottom:"10px",paddingRight:B?"0":"80px"}},(0,n.__)("Search Results","searchwiz"),$>0&&(0,e.createElement)("span",{style:{fontSize:"14px",color:"#666",fontWeight:"normal",marginLeft:"10px"}},"(",$,S?"+":""," ",(0,n.__)("shown","searchwiz"),")"),m&&(0,e.createElement)("span",{style:{fontSize:"14px",color:"#666",fontWeight:"normal",marginLeft:"10px"}},(0,n.__)("for","searchwiz"),' "',m,'"')),B&&(0,e.createElement)("div",{style:{marginBottom:"20px",position:"relative"}},(0,e.createElement)("input",{type:"search",className:"searchwiz-search-input",value:m,onChange:e=>{const t=e.target.value;if(_&&clearTimeout(_),t.length>=3){const e=setTimeout(()=>{const e=new URL(window.location);e.searchParams.set("isSearchpage","true"),e.searchParams.set("s",t),window.history.pushState({},"",e),f(t),E(1),i([]),l([]),C(t,1)},300);k(e)}else if(0===t.length){f(""),i([]),l([]);const e=new URL(window.location);e.searchParams.set("isSearchpage","true"),e.searchParams.delete("s"),window.history.pushState({},"",e)}},placeholder:(0,n.__)("Search...","searchwiz"),autoFocus:0===m.length,style:{width:"100%",maxWidth:"600px",padding:"12px 16px",fontSize:"16px",border:"2px solid #0073aa",borderRadius:"4px",boxSizing:"border-box",outline:"none"},onFocus:e=>{e.target.style.borderColor="#005a87",e.target.style.boxShadow="0 0 0 3px rgba(0,115,170,0.1)"},onBlur:e=>{e.target.style.borderColor="#0073aa",e.target.style.boxShadow="none"}})),c&&(0,e.createElement)("div",{style:{padding:"10px",color:"#666"}},(0,n.__)("Loading...","searchwiz")),g&&(0,e.createElement)("div",{style:{padding:"10px",color:"red"}},g),!c&&0===$&&m&&m.length>=3&&(0,e.createElement)("div",{style:{padding:"10px",color:"#666"}},(0,n.__)("No results found for","searchwiz"),' "',m,'"'),B&&!c&&0===m.length&&(0,e.createElement)("div",{style:{padding:"20px",textAlign:"center",color:"#666",fontSize:"15px"}},(0,n.__)("Enter a search term above to find products, pages, and posts","searchwiz")),!c&&(P||H)&&(0,e.createElement)("div",{"data-resizable-container":!0,onMouseMove:e=>{if(!T)return;const t=e.currentTarget.closest("[data-resizable-container]");if(!t)return;const n=t.getBoundingClientRect(),o=(e.clientX-n.left)/n.width*100;o>=30&&o<=70&&R(o)},onMouseUp:F,onMouseLeave:F,style:{display:"flex",gap:"0",position:"relative",userSelect:T?"none":"auto",cursor:T?"col-resize":"default"}},P&&(0,e.createElement)("div",{style:{width:x&&P&&H?`${M}%`:"100%",paddingRight:x&&P&&H?"10px":"0"}},(0,e.createElement)("h4",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#333",borderBottom:"1px solid #ddd",paddingBottom:"8px"}},(0,n.__)("Products","searchwiz")," (",s.length,")"),s.map(t=>(0,e.createElement)(r,{key:t.id,result:t}))),x&&P&&H&&(0,e.createElement)("div",{onMouseDown:e=>{e.preventDefault(),D(!0)},style:{width:"8px",cursor:"col-resize",background:T?"#0073aa":"#ddd",position:"relative",flexShrink:0,transition:T?"none":"background 0.2s",borderRadius:"4px",margin:"0 6px"},onMouseEnter:e=>{T||(e.target.style.background="#999")},onMouseLeave:e=>{T||(e.target.style.background="#ddd")}},(0,e.createElement)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"2px",height:"40px",background:T?"white":"#666",borderRadius:"1px"}})),H&&(!x||!P||x&&P)&&(0,e.createElement)("div",{style:{width:x&&P&&H?100-M+"%":"100%",paddingLeft:x&&P&&H?"10px":"0"}},x&&P&&(0,e.createElement)("h4",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#333",borderBottom:"1px solid #ddd",paddingBottom:"8px"}},(0,n.__)("Pages & Posts","searchwiz")," (",a.length,")"),a.map(t=>(0,e.createElement)(o,{key:t.id,result:t})))),!c&&S&&$>0&&(0,e.createElement)("div",{id:"searchwiz-scroll-sentinel",style:{height:"20px",width:"100%",marginTop:"10px"}}),u&&(0,e.createElement)("div",{style:{padding:"20px",textAlign:"center",color:"#666"}},(0,e.createElement)("div",{style:{fontSize:"14px"}},(0,n.__)("Loading more results...","searchwiz"))),!c&&!S&&$>0&&(0,e.createElement)("div",{style:{padding:"20px",textAlign:"center",color:"#999",fontSize:"14px",borderTop:"1px solid #ddd",marginTop:"20px"}},(0,n.__)("All results shown","searchwiz")))},i=()=>{const[e,n]=(0,t.useState)(""),[o,r]=(0,t.useState)(null),[a,i]=(0,t.useState)(""),s=(0,t.useRef)(null),l=window.searchwiz||{ajax_url:"",nonce:""};return(0,t.useEffect)(()=>{const t=document.querySelectorAll(".searchwiz-search-input");if(0===t.length)return;const o=e=>{const t=e.target.value.trim(),o=document.querySelector(".searchwiz-inline-suggestion");if(o&&o.remove(),s.current&&clearTimeout(s.current),t.length<2)return n(""),void i("");n(""),i(""),s.current=setTimeout(()=>{(async(e,t)=>{if(e.length<2)n("");else try{const o=new FormData;o.append("action","searchwiz_inline_suggestion"),o.append("security",l.nonce),o.append("q",e);const a=await fetch(l.ajax_url,{method:"POST",body:o}),s=await a.json();if(s.success&&s.data.suggestion){const o=s.data.suggestion;o.toLowerCase().startsWith(e.toLowerCase())?(n(o),r(t),i(e)):(n(""),i(""))}else n(""),i("")}catch(e){window.searchwizDebug?.log("âŒ Autocomplete error:",e),n("")}})(t,e.target)},300)},a=t=>{const o=t.target,r=o.value;"Tab"!==t.key&&"ArrowRight"!==t.key||!e||o.selectionStart===r.length&&(t.preventDefault(),o.value=e,n(""),o.dispatchEvent(new Event("input",{bubbles:!0}))),"Escape"===t.key&&e&&n("")};return t.forEach(e=>{e.addEventListener("input",o),e.addEventListener("keydown",a)}),()=>{s.current&&clearTimeout(s.current),t.forEach(e=>{e.removeEventListener("input",o),e.removeEventListener("keydown",a)})}},[e]),(0,t.useEffect)(()=>{const t=document.querySelector(".searchwiz-inline-suggestion");if(t&&t.remove(),!o||!e||!a)return;const n=o.value.trim(),r=e.substring(a.length);if(!r||n.toLowerCase()!==a.toLowerCase())return;const i=document.createElement("div");i.className="searchwiz-inline-suggestion",o.parentElement.style.position="relative";const s=window.getComputedStyle(o);return i.style.position="absolute",i.style.top=o.offsetTop+"px",i.style.left=o.offsetLeft+"px",i.style.width=o.offsetWidth+"px",i.style.height=o.offsetHeight+"px",i.style.pointerEvents="none",i.style.overflow="hidden",i.style.whiteSpace="pre",i.style.zIndex="1",i.style.display="block",i.style.fontFamily=s.fontFamily,i.style.fontSize=s.fontSize,i.style.fontWeight=s.fontWeight,i.style.letterSpacing=s.letterSpacing,i.style.textTransform=s.textTransform,i.style.paddingTop=s.paddingTop,i.style.paddingBottom=s.paddingBottom,i.style.paddingLeft=s.paddingLeft,i.style.paddingRight=s.paddingRight,i.style.margin="0",i.style.border="none",i.style.boxSizing=s.boxSizing,i.style.textAlign=s.textAlign,i.style.lineHeight=s.lineHeight,i.style.verticalAlign=s.verticalAlign,i.style.fontSmoothing=s.fontSmoothing,i.style.webkitFontSmoothing=s.webkitFontSmoothing,i.style.mozOsxFontSmoothing=s.mozOsxFontSmoothing,i.innerHTML=`<span style="visibility: hidden;">${a}</span><span style="color: #999;">${r}</span>`,o.parentElement.appendChild(i),()=>{const e=document.querySelector(".searchwiz-inline-suggestion");e&&e.remove()}},[e,o,a]),null};function s(){const n=document.getElementById("searchwiz-react-results");n&&(0,t.createRoot)(n).render((0,e.createElement)(e.Fragment,null,(0,e.createElement)(a,null),(0,e.createElement)(i,null)))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s):s()})();